(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-equip-equipRepair-reportManager-index"],{"0218":function(e,t,n){"use strict";n("7a82");var r=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.confirmRepairInit=function(e){return(0,a.default)({url:"/pbequipment/eqpRepair/confirm",method:"get",data:e})},t.confirmRepairSubmit=function(e){return(0,a.default)({url:"/pbequipment/eqpRepair/confirm",method:"post",data:e})},t.getDeviceRepair=function(e){return(0,a.default)({url:"/pbequipment/eqpRepair/infoById",method:"get",data:e})},t.getEqpByClass=function(e){return(0,a.default)({url:"/pbequipment/equipLedger/idNameByClazz",method:"get",data:e})},t.getEqpClass=function(e){return(0,a.default)({url:"/pbequipment/equipLedger/eqpClazz",method:"get",data:e})},t.getEqpinfo=function(e){return(0,a.default)({url:"/pbequipment/equipLedger/eqpInfo",method:"get",data:data})},t.getRepairInit=function(){return(0,a.default)({url:"/pbequipment/eqpRepair/reportInit",method:"get"})},t.getRepairMans=function(e){return(0,a.default)({url:"/pbequipment/eqpRepair/repairMan",method:"get",data:e})},t.queryEqpList=function(e){return(0,a.default)({url:"/pbequipment/equipLedger/info",method:"get",data:e})},t.submitRepair=function(e){return(0,a.default)({url:"/pbequipment/eqpRepair/report",method:"post",data:e})};var a=r(n("3d7c"))},"0b8e":function(e,t,n){var r=n("c2b3");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var a=n("4f06").default;a("678cfb28",r,!0,{sourceMap:!1,shadowMode:!1})},"1d55":function(e,t,n){"use strict";var r=n("0b8e"),a=n.n(r);a.a},"205f":function(e,t,n){"use strict";n("7a82");var r=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.BindNFC=function(e){return new Promise((function(t,n){(0,a.default)({url:"/app/my/card",data:e,method:"post"}).then((function(e){t(e)}))}))},t.login=function(e){return new Promise((function(t,n){(0,a.default)({url:s.login,method:"post",data:e}).then((function(e){c(e,t)})).catch((function(){t({err_code:40001,err_msg:"接口异常"})}))}))},t.loginScanCode=function(e){return new Promise((function(t,n){(0,a.default)({url:s.loginScanCode,method:"post",data:e}).then((function(e){c(e,t)})).catch((function(){t({err_code:40001,err_msg:"接口异常"})}))}))},t.updateWorkcard=function(e){return new Promise((function(t,n){(0,a.default)({url:"/app/my/updateWorkcard",data:e,method:"post"}).then((function(e){t(e)}))}))},n("7db0"),n("d3b7");var a=r(n("3d7c")),i=n("8e75"),o=r(n("fcb1")),u=n("e237"),s={login:"/auth/jwt/token",loginScanCode:"/auth/jwt/tokenScanCode"};function c(e,t){e.code===o.default.status.success?((0,u.setToken)(e.data.accessToken),(0,i.myInfo)().then((function(n){if(n.err_code===o.default.status.success2){if(!n.data.currRole||!n.data.roles||0===n.data.roles.length)return(0,u.removeToken)(),void t({err_code:40001,err_msg:"该用户未授予角色权限，请联系管理员"});n.data.accessToken=e.data.accessToken,n.data.userInfo=e.data.userInfo,(0,u.setUserInfo)(n.data.userInfo),(0,u.setUserRoleList)(n.data.roles);var r=n.data.roles.find((function(e){return e.id===n.data.currRole.k}));if(r)(0,u.setCurrRole)(r);else{var a=n.data.currRole;(0,u.setCurrRole)({id:a.k,roleName:a.v})}}t(n)})).catch((function(){t({err_code:40001,err_msg:"接口异常"})}))):t({err_code:40001,err_msg:e.msg})}},2508:function(e,t,n){"use strict";n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("d3b7"),n("159b");var r=n("0218"),a=n("9b6c"),i={data:function(){return{repairData:""}},methods:{onShow:function(){var e=this;this.repairData=[];(0,r.getDeviceRepair)({pg_pagesize:100,pg_pagenum:1}).then((function(t){console.log("查询的维修设备",t),e.repairData=t.data,e.repairData.forEach((function(e){"0"==e.status?e.repairStatus="报修未响应":"1"==e.status?e.repairStatus="响应检测中":"2"==e.status?e.repairStatus="待二次维修":"3"==e.status?e.repairStatus="维修中":"4"==e.status?e.repairStatus="待件、待人中":"5"==e.status?e.repairStatus="维修完成":"6"==e.status&&(e.repairStatus="维修已确认")}))}))},itemClick:function(e){"维修完成"==e.repairStatus?uni.navigateTo({url:"/pages/equip/equipRepair/reportManager/ensure?repairmgtId="+e.repairmgtId}):(0,a.$confirm)("只有维修状态为已完成的设备才能进行维修确认操作!").then((function(e){}))},reportRepair:function(){uni.navigateTo({url:"/pages/equip/equipRepair/reportManager/equipReport"})},orderRepair:function(){uni.navigateTo({url:"/pages/equip/equipRepair/reportManager/orderReport"})}}};t.default=i},"360f":function(e,t,n){"use strict";n.r(t);var r=n("2508"),a=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=a.a},"3d7c":function(e,t,n){"use strict";n("7a82");var r=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.getUrl=s;var a=r(n("5530"));n("e9c4"),n("d3b7"),n("c975");var i=n("e237"),o=n("70f3"),u=r(n("fcb1"));r(n("205f"));function s(e){var t=(0,o.getAjaxUrl)();return t="/api",console.log("request ---"+t),t+e}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"token过期，请重新登录";uni.showToast({icon:"none",title:e,duration:2e3})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"token过期，请重新登录";c(e),(0,i.setToken)(""),uni.showToast({icon:"none",title:e,duration:2e3,complete:function(){uni.reLaunch({url:"/pages/login/login"})}})}var f=function(e){var t=e.url,n=e.data,r=e.method,o=e.source,f=void 0===o?"":o,l=e.fromdata,p=(e.format,e.moreParams),g=void 0===p?{}:p,m=e.header,v=void 0===m?{"content-type":"application/json"}:m;return console.log(JSON.stringify(n)),v["content-type"]=l&&"fromdata"==l?"application/x-www-form-urlencoded; charset=UTF-8":"application/json",(0,i.getToken)()&&(v["authorization"]=(0,i.getToken)()),new Promise((function(e,i){var o=s(t,f);console.log(o),uni.request((0,a.default)((0,a.default)({url:o,data:n,method:r,header:v},g),{},{success:function(t){if(404!==t.statusCode)if("arraybuffer"===g.responseType)e(t);else{if(401===t.statusCode)return void d();t.data.err_code&&t.data.err_code!=u.default.status.success2?t.data.err_msg.indexOf("过期")>=0||t.data.err_msg.indexOf("未登录")>=0||401===t.data.err_code?d(t.data.err_msg):e(t.data):(console.log(t.data),e(t.data))}else uni.showToast({icon:"none",title:"接口404错误，可能是后台服务异常",duration:3e3})},fail:function(e){console.error(JSON.stringify(e)),e&&e.errMsg.indexOf("Failed to connect")>=0&&c("请在登录页选择正确的网络模式并重新登录"),i(e)}}))}))};t.default=f},"531e":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"hp app-containerR"},[n("v-uni-view",{staticClass:"app-containerC",staticStyle:{width:"140px","padding-left":"20px"}},[n("v-uni-button",{staticClass:"btn m-10",attrs:{type:"primary",size:"mini"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.reportRepair.apply(void 0,arguments)}}},[e._v("设备报修")]),n("v-uni-button",{staticClass:"btn m-10",attrs:{type:"primary",size:"mini"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.orderRepair.apply(void 0,arguments)}}},[e._v("预约维修")])],1),n("v-uni-view",{staticClass:"line"}),n("v-uni-view",{staticClass:"app-containerC"},[n("v-uni-view",{staticClass:"titleCls"},[e._v("已报修设备：")]),n("v-uni-view",{staticClass:"app-containerR app-containerWrap"},e._l(e.repairData,(function(t,r){return n("v-uni-view",{key:t.repairmgtId,staticClass:"group-warter w-240 tc text bg-blue",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.itemClick(t)}}},[n("v-uni-view",{staticClass:"group-title"},[e._v("设备编号："+e._s(t.number))]),n("v-uni-view",{staticClass:"group-bomtitle tc"},[e._v("设备名称："+e._s(t.name))]),n("v-uni-view",{staticClass:"group-bomtitle tc",class:{"text-red":0==t.status}},[e._v("维修状态："+e._s(t.repairStatus))])],1)})),1)],1)],1)],1)},a=[]},"687e":function(e,t,n){"use strict";n.r(t);var r=n("531e"),a=n("360f");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("1d55");var o=n("f0c5"),u=Object(o["a"])(a["default"],r["b"],r["c"],!1,null,"1dd99e88",null,!1,r["a"],void 0);t["default"]=u.exports},"70f3":function(e,t,n){"use strict";n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.getAjaxUrl=function(){var e="z"===(0,r.getFormalData)();return e?"http://dqmes.tbea-hb.com.cn/api":"http://192.168.100.50/api"},t.getApkDownloadUrl=function(){return a},t.getFileServerUrl=function(){return"http://dqmes.tbea-hb.com.cn/minioServer/"};n("f542");var r=n("e237"),a="http://dqmes.tbea-hb.com.cn/"},"8e75":function(e,t,n){"use strict";n("7a82");var r=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.bindingGpId=function(e){return(0,a.default)({url:i.bindingGpId,method:"post",data:e})},t.chgcurrrole=function(e){return(0,a.default)({url:i.chgcurrrole,method:"post",data:e})},t.currperm=function(e){return(0,a.default)({url:i.currperm,method:"get",data:e})},t.getBindingInfo=function(e){return(0,a.default)({url:i.getBindingInfo,method:"get",data:e})},t.lineWorkSpace=function(){return(0,a.default)({url:i.lineWorkSpace,method:"get"})},t.myInfo=function(e){return(0,a.default)({url:i.myInfo,method:"get",data:e})},t.unbindingGpId=function(e){return(0,a.default)({url:i.unbindingGpId,method:"post",data:e})};var a=r(n("3d7c")),i={myInfo:"/pbpermissions/my/info",currperm:"/pbpermissions/my/currperm",chgcurrrole:"/pbpermissions/my/chgcurrrole",bindingGpId:"/pbpermissions/userInfo/bindingGpId",unbindingGpId:"/pbpermissions/userInfo/unbindingGpId",getBindingInfo:"/pbpermissions/userInfo/getBindingInfo",lineWorkSpace:"/pbproduction/workSpace/lineWorkSpace"}},"9b6c":function(e,t,n){"use strict";n("7a82");var r=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.$confirm=function(e){return new Promise((function(t,n){uni.showModal({title:"提示",content:e,success:function(e){e.confirm?t():uni.showToast({icon:"none",title:"已取消",duration:1e3})}})}))},t.$message=function(e){setTimeout((function(){uni.showToast({icon:"none",title:e,duration:3e3})}),100)},t.getCardInfo=function(e){return a.default.isNotEmpty(e)&&e.indexOf("PNO=")>=0?e.substr(e.indexOf("PNO=")+4):""},t.getValueFromList=function(e,t){var n=e.find((function(e){return e.code===t}));return n?n.name:""},t.getVersion=i,t.getVersionDesc=function(){var e="z"===getFormalData(),t=i();return t=o(e,t).label,t},t.getVersionItem=o,t.isEmptyObj=function(e){return"{}"==JSON.stringify(e)},t.needUpVersion=function(e){return new Promise((function(e,t){e({needUp:!1,widgetInfo:{}})}))},t.timeTranslate=function(e){var t=e?new Date(e):new Date,n=t.getMonth()+1,r=t.getDate();n>=1&&n<=9&&(n="0"+n);r>=0&&r<=9&&(r="0"+r);var a=t.getFullYear()+"-"+n+"-"+r;return a},n("d3b7"),n("e9c4"),n("7db0"),n("e25e"),n("c975");var a=r(n("fcb1"));function i(){return""}function o(e,t){return t&&(t="V"+t),e?{type:a.default.flag.y,label:"正式版"+t}:{type:a.default.flag.n,label:"测试版"+t}}},c2b3:function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".group-bomtitle[data-v-1dd99e88]{padding:10px}.line[data-v-1dd99e88]{margin-left:20px;width:%?2?%;background-color:#0081ff}.titleCls[data-v-1dd99e88]{color:#0081ff;font-size:15px;margin-left:20px}",""]),e.exports=t},e237:function(e,t,n){"use strict";n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrRole=function(){try{var e=uni.getStorageSync("hb_dq_mes_currRoleKey");return JSON.parse(e)}catch(t){return{}}},t.getFormalData=function(){var e=uni.getStorageSync("hb_dq_mes_formalKey");return"c"!==e?"z":"c"},t.getToken=function(){return uni.getStorageSync(r)},t.getUserInfo=function(){try{var e=uni.getStorageSync("hb_dq_mes_user_info");return JSON.parse(e)}catch(t){return{}}},t.getUserRoleList=function(){try{var e=uni.getStorageSync("hb_dq_mes_userRoleKey");return JSON.parse(e)}catch(t){return[]}},t.removeToken=function(){return uni.removeStorageSync(r)},t.removeUserInfo=function(){return uni.removeStorageSync("hb_dq_mes_user_info")},t.setCurrRole=function(e){var t=JSON.stringify(e);return uni.setStorageSync("hb_dq_mes_currRoleKey",t)},t.setFormalData=function(e){return uni.setStorageSync("hb_dq_mes_formalKey",e)},t.setToken=function(e){return uni.setStorageSync(r,e)},t.setUserInfo=function(e){var t=JSON.stringify(e);return uni.setStorageSync("hb_dq_mes_user_info",t)},t.setUserRoleList=function(e){var t=JSON.stringify(e);return uni.setStorageSync("hb_dq_mes_userRoleKey",t)},n("e9c4");var r="hb_dq_mes_uniapp_token"}}]);