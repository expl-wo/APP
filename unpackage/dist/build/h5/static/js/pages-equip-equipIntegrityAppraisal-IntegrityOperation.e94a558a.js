(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-equip-equipIntegrityAppraisal-IntegrityOperation"],{"08a8":function(t,e,n){"use strict";n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("d3b7"),n("159b"),n("d401"),n("25f0");var a=n("cb5e"),i=n("73bd"),s={data:function(){return{task:null,checkData:{equipmentPerson:null,userDepartment:null,technologyPerson:null,personLiable:null}}},onLoad:function(t){this.task=JSON.parse(t.deviceItem),console.log(this.task),(0,a.getTaskDetails)({taskId:this.task.id}).then((function(t){console.log(2),1e4===t.err_code||uni.showToast({title:t.err_msg,duration:1e3})})),this.initData()},methods:{handleChange:function(t,e){e.isError=t.detail.value},preview:function(t){uni.previewImage({current:0,urls:t.pictures,indicator:"number",loop:!0})},scan:function(t){var e=this;uni.scanCode({onlyFromCamera:!0,success:function(n){var a=n.result.split("&");(0,i.getUserData)({code:a[1]}).then((function(n){var a=n.data;e.task[t]=a.id,"personLiable"==t&&(e.task.personTime=new Date),"technologyPerson"==t&&(e.task.technologyTime=new Date),"userDepartment"==t&&(e.task.userDepartmentTime=new Date),"equipmentPerson"==t&&(e.task.equipmentTime=new Date),e.checkData[t]=a.name}))},fail:function(t){console.log(t),console.log("falut")}})},saveOrFinish:function(t){var e=this,n=!0;if(2==t)this.task.details.forEach((function(t){return 2!=t.isError||null!=t.errorMsg&&""!=t.errorMsg?null==t.actualValue||""==t.actualValue?(uni.showToast({title:"有项目未鉴定",duration:1e3}),void(n=!1)):void 0:(uni.showToast({title:"请输入异常信息",duration:1e3}),void(n=!1))}));else if(3==t){if(null==this.task.equipmentPerson||""==this.task.equipmentPerson)return void uni.showToast({title:"设备部未验收",duration:1e3});if(null==this.task.userDepartment||""==this.task.userDepartment)return void uni.showToast({title:"使用部门未验收",duration:1e3});if(null==this.task.technologyPerson||""==this.task.technologyPerson)return void uni.showToast({title:"工艺部未验收",duration:1e3});if(null==this.task.personLiable||""==this.task.personLiable)return void uni.showToast({title:"鉴定责任人未验收",duration:1e3})}n&&(this.task.status=t,this.task.details.forEach((function(t){null!=t.pictures&&(t.pictures=t.pictures.toString())})),appraisal.saveOrFinishTask({task:this.task,taskDeList:this.task.details}).then((function(n){var a=null;1==t?a="保存":2==t?a="鉴定":3==t&&(a="验收"),1e4==n.err_code?(uni.showToast({icon:"success",title:a+"成功",duration:1e3}),uni.navigateBack()):(uni.showToast({title:a+"失败",duration:1e3}),e.task.details.forEach((function(t){t.pictures=t.pictures.split(",")})))})))},cancel:function(){uni.navigateBack()},initData:function(){null!=this.task.equipmentPerson&&(this.checkData.equipmentPerson=this.task.equipmentPersonName),null!=this.task.userDepartment&&(this.checkData.userDepartment=this.task.userDepartmentName),null!=this.task.technologyPerson&&(this.checkData.technologyPerson=this.task.technologyPersonName),null!=this.task.personLiable&&(this.checkData.personLiable=this.task.personLiableName)}}};e.default=s},"1e12":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a}));var a={uInput:n("38ad").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"main"},[n("v-uni-view",{staticClass:"item"},[n("v-uni-view",{staticClass:"item-header"},[n("v-uni-view",{staticClass:"header-text",staticStyle:{"background-color":"rgb(22,155,213)"}},[n("v-uni-view",{staticClass:"header-text-item"},[t._v("鉴定内容："+t._s(t.task.name))])],1),n("v-uni-view",{staticStyle:{"margin-top":"10px"}}),n("v-uni-view",[n("v-uni-view",{staticStyle:{"margin-top":"20px"}},[n("v-uni-view",{staticClass:"main-form"},[n("v-uni-view",{staticClass:"de-form",staticStyle:{"margin-right":"30px"}},[n("v-uni-view",{staticStyle:{"align-self":"center"}},[t._v("鉴定责任人")]),n("u-input",{staticStyle:{"margin-left":"10px","min-width":"80px"},attrs:{disabled:!0,placeholder:"",height:"40px"},model:{value:t.checkData.personLiable,callback:function(e){t.$set(t.checkData,"personLiable",e)},expression:"checkData.personLiable"}}),n("v-uni-button",{staticClass:"btn",staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.scan("personLiable")}}},[t._v("扫码")])],1),n("v-uni-view",{staticClass:"de-form"},[n("v-uni-view",{staticStyle:{"align-self":"center"}},[t._v("使用部门验收")]),n("u-input",{staticStyle:{"margin-left":"10px","min-width":"80px"},attrs:{disabled:!0,placeholder:"",height:"40px"},model:{value:t.checkData.userDepartment,callback:function(e){t.$set(t.checkData,"userDepartment",e)},expression:"checkData.userDepartment"}}),n("v-uni-button",{staticClass:"btn",staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.scan("userDepartment")}}},[t._v("扫码")])],1),n("v-uni-view",{staticClass:"de-form",staticStyle:{"margin-right":"30px"}},[n("v-uni-view",{staticStyle:{"align-self":"center"}},[t._v("工艺部验收")]),n("u-input",{staticStyle:{"margin-left":"10px","min-width":"80px"},attrs:{disabled:!0,placeholder:"",height:"40px"},model:{value:t.checkData.technologyPerson,callback:function(e){t.$set(t.checkData,"technologyPerson",e)},expression:"checkData.technologyPerson"}}),n("v-uni-button",{staticClass:"btn",staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.scan("technologyPerson")}}},[t._v("扫码")])],1),n("v-uni-view",{staticClass:"de-form"},[n("v-uni-view",{staticStyle:{"align-self":"center"}},[t._v("设备部验收")]),n("u-input",{staticStyle:{"margin-left":"10px","min-width":"80px"},attrs:{disabled:!0,placeholder:"",height:"40px"},model:{value:t.checkData.equipmentPerson,callback:function(e){t.$set(t.checkData,"equipmentPerson",e)},expression:"checkData.equipmentPerson"}}),n("v-uni-button",{staticClass:"btn",staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.scan("equipmentPerson")}}},[t._v("扫码")])],1)],1),n("v-uni-view",{staticClass:"main-form",staticStyle:{"padding-top":"25px","justify-content":"center","flex-wrap":"nowrap"}},[n("v-uni-view",[n("v-uni-button",{staticClass:"btn",attrs:{size:"mini",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveOrFinish(1)}}},[t._v("保存")])],1),n("v-uni-view",{staticStyle:{"margin-left":"100px"}},[n("v-uni-button",{staticClass:"btn",attrs:{size:"mini",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cancel()}}},[t._v("取消")])],1),2==t.task.status?n("v-uni-view",{staticStyle:{"margin-left":"100px"}},[n("v-uni-button",{staticClass:"btn",attrs:{size:"mini",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveOrFinish(3)}}},[t._v("验收完成")])],1):n("v-uni-view",{staticStyle:{"margin-left":"100px"}},[n("v-uni-button",{staticClass:"btn",attrs:{size:"mini",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveOrFinish(2)}}},[t._v("鉴定完成")])],1)],1)],1)],1)],1)],1)],1)],1)},s=[]},"244a":function(t,e,n){"use strict";var a=n("ec0a"),i=n.n(a);i.a},2901:function(t,e,n){"use strict";n.r(e);var a=n("1e12"),i=n("9776");for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("244a");var r=n("f0c5"),o=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,"04b32abb",null,!1,a["a"],void 0);e["default"]=o.exports},"73bd":function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.getProductionCode=function(t){return new Promise((function(e,n){(0,i.default)({url:"/app/qrScan/findProductionCode",data:t,method:"post"}).then((function(t){e(t)}))}))},e.getProductionData=function(t){return new Promise((function(e,n){(0,i.default)({url:"/app/qrScan/findData?productionCode="+t.productionCode,method:"get"}).then((function(t){e(t)}))}))},e.getUserData=function(t){return new Promise((function(e,n){(0,i.default)({url:"/user/app/scan",method:"post",data:t}).then((function(t){e(t)}))}))},e.getUserInfos=function(t){return new Promise((function(e,n){(0,i.default)({url:"/user/UserInfos?userId="+t,method:"get"}).then((function(t){e(t)}))}))},n("d3b7");var i=a(n("3d7c"))},9776:function(t,e,n){"use strict";n.r(e);var a=n("08a8"),i=n.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e["default"]=i.a},cb5e:function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.getAprriaseTask=function(t){return(0,i.default)({url:"/pbequipment/integrityAppraisal/getTaskList",method:"get",data:t})},e.getTaskDetails=function(t){return(0,i.default)({url:"/pbequipment/integrityAppraisal/getTaskDetails",method:"get",data:t})};var i=a(n("3d7c"))},ec0a:function(t,e,n){var a=n("f14a");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("0398db97",a,!0,{sourceMap:!1,shadowMode:!1})},f14a:function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.main[data-v-04b32abb]{width:90%;margin:0 auto}.item[data-v-04b32abb]{margin-top:%?10?%;background-color:#fff;border-radius:%?5?%;padding:%?20?% %?10?% %?15?%;width:100%;position:relative}.item-header[data-v-04b32abb]{align-items:center}.header-text[data-v-04b32abb]{padding:%?5?% %?8?%;margin-left:0;background-color:#0081ff;border-radius:%?5?%;border:%?1?% solid #a0cfff;font-size:%?13?%;display:flex;width:100%}.header-text .header-text-item[data-v-04b32abb]{margin-left:%?8?%;color:#fff}.main-form[data-v-04b32abb]{display:flex;justify-content:flex-start;flex-wrap:wrap;padding:20px}.main-form .de-form[data-v-04b32abb]{margin-left:30px;display:flex;min-width:320px;width:45%;height:45px;margin-top:10px}.btn[data-v-04b32abb]{font-size:13px;height:40px}[data-v-04b32abb] .u-td{height:auto}[data-v-04b32abb] .uni-input-input,\r\n.uni-input-placeholder[data-v-04b32abb]{font-size:14px;min-height:0}',""]),t.exports=e}}]);