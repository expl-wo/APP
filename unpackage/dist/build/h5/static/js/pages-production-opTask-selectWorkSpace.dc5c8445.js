(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-production-opTask-selectWorkSpace"],{"163b":function(e,t,n){"use strict";n.r(t);var r=n("cfba"),o=n.n(r);for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);t["default"]=o.a},"205f":function(e,t,n){"use strict";n("7a82");var r=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.BindNFC=function(e){return new Promise((function(t,n){(0,o.default)({url:"/app/my/card",data:e,method:"post"}).then((function(e){t(e)}))}))},t.login=function(e){return new Promise((function(t,n){(0,o.default)({url:c.login,method:"post",data:e}).then((function(e){d(e,t)})).catch((function(){t({err_code:40001,err_msg:"接口异常"})}))}))},t.loginScanCode=function(e){return new Promise((function(t,n){(0,o.default)({url:c.loginScanCode,method:"post",data:e}).then((function(e){d(e,t)})).catch((function(){t({err_code:40001,err_msg:"接口异常"})}))}))},t.updateWorkcard=function(e){return new Promise((function(t,n){(0,o.default)({url:"/app/my/updateWorkcard",data:e,method:"post"}).then((function(e){t(e)}))}))},n("7db0"),n("d3b7");var o=r(n("3d7c")),a=n("8e75"),u=r(n("fcb1")),i=n("e237"),c={login:"/auth/jwt/token",loginScanCode:"/auth/jwt/tokenScanCode"};function d(e,t){e.code===u.default.status.success?((0,i.setToken)(e.data.accessToken),(0,a.myInfo)().then((function(n){if(n.err_code===u.default.status.success2){if(!n.data.currRole||!n.data.roles||0===n.data.roles.length)return(0,i.removeToken)(),void t({err_code:40001,err_msg:"该用户未授予角色权限，请联系管理员"});n.data.accessToken=e.data.accessToken,n.data.userInfo=e.data.userInfo,(0,i.setUserInfo)(n.data.userInfo),(0,i.setUserRoleList)(n.data.roles);var r=n.data.roles.find((function(e){return e.id===n.data.currRole.k}));if(r)(0,i.setCurrRole)(r);else{var o=n.data.currRole;(0,i.setCurrRole)({id:o.k,roleName:o.v})}}t(n)})).catch((function(){t({err_code:40001,err_msg:"接口异常"})}))):t({err_code:40001,err_msg:e.msg})}},"2b40":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){}));var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"content"},e._l(e.workSpaceList,(function(t){return n("v-uni-view",{staticClass:"app-containerC app-containerWrap "},[n("v-uni-label",{staticClass:"label"},[e._v(e._s(t.name)+"("+e._s(t.taskCount)+"):")]),n("v-uni-view",{staticClass:"app-containerR app-containerWrap"},e._l(t.sub,(function(r){return n("v-uni-view",e._b({key:r.name,staticClass:"group-warter w-195 tc  ",style:{background:r.color,"white-space":"normal",height:"auto"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.tap(r)}}},"v-uni-view",t.sub,!1),[e._v(e._s(r.name)),n("br"),e._v(e._s(r.wkNumber)),n("br"),e._v("任务数："+e._s(r.taskCount)+","+e._s(r.initTaskCount)+","+e._s(r.specialTaskCount))])})),1)],1)})),1)},o=[]},"3d7c":function(e,t,n){"use strict";n("7a82");var r=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.getUrl=c;var o=r(n("5530"));n("e9c4"),n("d3b7"),n("c975");var a=n("e237"),u=n("70f3"),i=r(n("fcb1"));r(n("205f"));function c(e){var t=(0,u.getAjaxUrl)();return t="/api",console.log("request ---"+t),t+e}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"token过期，请重新登录";uni.showToast({icon:"none",title:e,duration:2e3})}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"token过期，请重新登录";d(e),(0,a.setToken)(""),uni.showToast({icon:"none",title:e,duration:2e3,complete:function(){uni.reLaunch({url:"/pages/login/login"})}})}var f=function(e){var t=e.url,n=e.data,r=e.method,u=e.source,f=void 0===u?"":u,l=e.fromdata,p=(e.format,e.moreParams),g=void 0===p?{}:p,m=e.header,h=void 0===m?{"content-type":"application/json"}:m;return console.log(JSON.stringify(n)),h["content-type"]=l&&"fromdata"==l?"application/x-www-form-urlencoded; charset=UTF-8":"application/json",(0,a.getToken)()&&(h["authorization"]=(0,a.getToken)()),new Promise((function(e,a){var u=c(t,f);console.log(u),uni.request((0,o.default)((0,o.default)({url:u,data:n,method:r,header:h},g),{},{success:function(t){if(404!==t.statusCode)if("arraybuffer"===g.responseType)e(t);else{if(401===t.statusCode)return void s();t.data.err_code&&t.data.err_code!=i.default.status.success2?t.data.err_msg.indexOf("过期")>=0||t.data.err_msg.indexOf("未登录")>=0||401===t.data.err_code?s(t.data.err_msg):e(t.data):(console.log(t.data),e(t.data))}else uni.showToast({icon:"none",title:"接口404错误，可能是后台服务异常",duration:3e3})},fail:function(e){console.error(JSON.stringify(e)),e&&e.errMsg.indexOf("Failed to connect")>=0&&d("请在登录页选择正确的网络模式并重新登录"),a(e)}}))}))};t.default=f},4054:function(e,t,n){var r=n("60fb");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var o=n("4f06").default;o("56516380",r,!0,{sourceMap:!1,shadowMode:!1})},"60fb":function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".label[data-v-fbf603ee]{margin:10px;font-size:22px!important;float:left}",""]),e.exports=t},"70f3":function(e,t,n){"use strict";n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.getAjaxUrl=function(){var e="z"===(0,r.getFormalData)();return e?"http://dqmes.tbea-hb.com.cn/api":"http://192.168.100.50/api"},t.getApkDownloadUrl=function(){return o},t.getFileServerUrl=function(){return"http://dqmes.tbea-hb.com.cn/minioServer/"};n("f542");var r=n("e237"),o="http://dqmes.tbea-hb.com.cn/"},7151:function(e,t,n){"use strict";n("7a82");var r=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.addMaterial=function(e){return(0,o.default)({url:"/pbproduction/scan/addParts",method:"POST",data:e})},t.addOrEditOpKeyMaterial=function(e){return(0,o.default)({url:"/pbproduction/opKeyMaterial/addOrEditOpKeyMaterial",method:"post",data:e})},t.changeWorkspace=function(e){return(0,o.default)({url:"/pbproduction/workSpace/changeWorkspace",method:"post",data:e})},t.delOpKeyMaterial=function(e){return(0,o.default)({url:"/pbproduction/opKeyMaterial/delOpKeyMaterial",method:"post",data:e})},t.findInstanceByWork=function(e){return(0,o.default)({url:"/pbproduction/workSpace/findInstanceByWork",method:"get",data:{workSpaceId:e.workspaceId}})},t.findLineSteps=function(){return(0,o.default)({url:"/pbproduction/workSpace/findLineSteps",method:"get"})},t.getBom=function(e){return(0,o.default)({url:"/pbplan/production/getBom",method:"get",data:e})},t.getBomByDrawingNo=function(e){return(0,o.default)({url:"/scheduling/plm/getBomByDrawingNo",method:"get",data:e})},t.getCheckInfo=function(e){return(0,o.default)({url:"/pbproduction/productTask/getCheckInfo?opPlanId="+e.opPlanId,method:"get"})},t.getDrawingBom=function(e){return(0,o.default)({url:"/pbproduction/productTask/getDrawingBom",method:"get",data:e})},t.getLastProcedure=function(e){return(0,o.default)({url:"/pbproduction/productTask/getLastProcedure",method:"get",data:e})},t.getOpInfo=function(e){return(0,o.default)({url:"/pbproduction/productTask/getOpInfo?opPlanId="+e.opPlanId,method:"get"})},t.getOpKeyMaterial=function(e){return(0,o.default)({url:"/pbproduction/opKeyMaterial/findOpKeyMaterial",method:"get",data:e})},t.getOpTask=function(e){return(0,o.default)({url:"/pbproduction/productTask/getTaskList",method:"get",data:e})},t.getPauseReason=function(){return(0,o.default)({url:"/pbproduction/stopReason/getList",method:"get"})},t.lineWork=function(){return(0,o.default)({url:"/pbproduction/workSpace/lineWorkSpace",method:"get"})},t.opFinish=function(e){return(0,o.default)({url:"/pbproduction/productReport/productFinish",method:"post",data:e})},t.opReport=function(e){return(0,o.default)({url:"/pbproduction/productReport/productReport",method:"post",data:e})},t.opRestart=function(e){return(0,o.default)({url:"/pbproduction/productReport/restart",method:"get",data:e})},t.opStart=function(e){return(0,o.default)({url:"/pbproduction/productStart/opBatchStart",method:"post",data:e})},t.opStop=function(e){return(0,o.default)({url:"/pbproduction/productReport/pause",method:"get",data:e})},t.queryClazzMember=function(e){return(0,o.default)({url:"/pbproduction/teamwork/teamPerson",method:"get",data:e})},t.queryTeamMember=function(e){return(0,o.default)({url:"/pbproduction/teamwork/queryTeamUser",method:"get",data:e})};var o=r(n("3d7c"))},"8e75":function(e,t,n){"use strict";n("7a82");var r=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.bindingGpId=function(e){return(0,o.default)({url:a.bindingGpId,method:"post",data:e})},t.chgcurrrole=function(e){return(0,o.default)({url:a.chgcurrrole,method:"post",data:e})},t.currperm=function(e){return(0,o.default)({url:a.currperm,method:"get",data:e})},t.getBindingInfo=function(e){return(0,o.default)({url:a.getBindingInfo,method:"get",data:e})},t.lineWorkSpace=function(){return(0,o.default)({url:a.lineWorkSpace,method:"get"})},t.myInfo=function(e){return(0,o.default)({url:a.myInfo,method:"get",data:e})},t.unbindingGpId=function(e){return(0,o.default)({url:a.unbindingGpId,method:"post",data:e})};var o=r(n("3d7c")),a={myInfo:"/pbpermissions/my/info",currperm:"/pbpermissions/my/currperm",chgcurrrole:"/pbpermissions/my/chgcurrrole",bindingGpId:"/pbpermissions/userInfo/bindingGpId",unbindingGpId:"/pbpermissions/userInfo/unbindingGpId",getBindingInfo:"/pbpermissions/userInfo/getBindingInfo",lineWorkSpace:"/pbproduction/workSpace/lineWorkSpace"}},a20e:function(e,t,n){"use strict";n.r(t);var r=n("2b40"),o=n("163b");for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("c93d");var u=n("f0c5"),i=Object(u["a"])(o["default"],r["b"],r["c"],!1,null,"fbf603ee",null,!1,r["a"],void 0);t["default"]=i.exports},c93d:function(e,t,n){"use strict";var r=n("4054"),o=n.n(r);o.a},cfba:function(e,t,n){"use strict";n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("ac1f"),n("5319"),n("e9c4"),n("d3b7"),n("159b");var r=n("7151"),o={data:function(){return{workSpaceList:[]}},methods:{tap:function(e){var t=this;if(0===e.isEmpower);else{this.station=e;var n={productLineId:this.station.productLineId,workspaceId:this.station.wkNumber};(0,r.findInstanceByWork)({workspaceId:this.station.id}).then((function(e){if(null==e.data||0===e.data.list.length)(0,r.changeWorkspace)(n).then((function(e){1e4===e.err_code&&(uni.navigateTo({url:"/pages/production/opTask/index"}),uni.setStorageSync("workSpace",t.station.name))}));else{var o=encodeURIComponent(JSON.stringify(e.data)).replace(/%/g,"%25"),a=encodeURIComponent(JSON.stringify(t.station)).replace(/%/g,"%25");uni.navigateTo({url:"/pages/production/opTask/selectPosition?item="+o+"&station="+a})}}))}},processData:function(e){e.forEach((function(e){var t=e.sub;t&&t.length>0&&t.forEach((function(e){1===e.isEmpower?e["color"]="#4cd6f5":2===e.isEmpower?e["color"]="#bbf75e":0===e.isEmpower&&(e["color"]="#e5e5e5")}))}))},resetting:function(){var e=this;(0,r.changeWorkspace)({productLineId:null,workspaceId:null}).then((function(t){1e4===t.err_code&&e.onBtnQuery()}))}},onLoad:function(){var e=this;(0,r.findLineSteps)().then((function(t){e.processData(t.data),e.workSpaceList=t.data}))}};t.default=o},e237:function(e,t,n){"use strict";n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrRole=function(){try{var e=uni.getStorageSync("hb_dq_mes_currRoleKey");return JSON.parse(e)}catch(t){return{}}},t.getFormalData=function(){var e=uni.getStorageSync("hb_dq_mes_formalKey");return"c"!==e?"z":"c"},t.getToken=function(){return uni.getStorageSync(r)},t.getUserInfo=function(){try{var e=uni.getStorageSync("hb_dq_mes_user_info");return JSON.parse(e)}catch(t){return{}}},t.getUserRoleList=function(){try{var e=uni.getStorageSync("hb_dq_mes_userRoleKey");return JSON.parse(e)}catch(t){return[]}},t.removeToken=function(){return uni.removeStorageSync(r)},t.removeUserInfo=function(){return uni.removeStorageSync("hb_dq_mes_user_info")},t.setCurrRole=function(e){var t=JSON.stringify(e);return uni.setStorageSync("hb_dq_mes_currRoleKey",t)},t.setFormalData=function(e){return uni.setStorageSync("hb_dq_mes_formalKey",e)},t.setToken=function(e){return uni.setStorageSync(r,e)},t.setUserInfo=function(e){var t=JSON.stringify(e);return uni.setStorageSync("hb_dq_mes_user_info",t)},t.setUserRoleList=function(e){var t=JSON.stringify(e);return uni.setStorageSync("hb_dq_mes_userRoleKey",t)},n("e9c4");var r="hb_dq_mes_uniapp_token"}}]);