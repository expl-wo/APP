(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-equip-equipMaintenance-maintenanceOperation"],{"0bbe":function(e,t,a){"use strict";a.r(t);var i=a("d94f"),n=a("2a97");for(var r in n)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(r);a("7891");var c=a("f0c5"),o=Object(c["a"])(n["default"],i["b"],i["c"],!1,null,"d8ab8e0a",null,!1,i["a"],void 0);t["default"]=o.exports},"176d":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return i}));var i={uInput:a("38ad").default,uUpload:a("4dfe").default,uPopup:a("e6ab").default,uCheckbox:a("0bbe").default},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"content"},[a("v-uni-view",[e._v(e._s(e.deviceItem.eqpName))]),a("v-uni-view",{staticClass:"app-containerC wp table-zdy"},[a("v-uni-view",{staticClass:"th-group"},[a("v-uni-view",{staticClass:"th"},[e._v("步骤")]),a("v-uni-view",{staticClass:"th"},[e._v("保养项名称")]),a("v-uni-view",{staticClass:"th"},[e._v("保养描述")]),a("v-uni-view",{staticClass:"th"},[e._v("保养记录")]),a("v-uni-view",{staticClass:"th"},[e._v("操作")])],1),e._l(e.maintenanceItemSData,(function(t,i){return a("v-uni-view",{key:i,staticClass:"td-group"},[a("v-uni-view",{staticClass:"td"},[e._v(e._s(t.step))]),a("v-uni-view",{staticClass:"td"},[e._v(e._s(t.name))]),a("v-uni-view",{staticClass:"td"},[e._v(e._s(t.description))]),a("v-uni-view",{staticClass:"td"},[1===t.needText?a("u-input",{attrs:{height:40,"placeholder-style":"font-size: 12px;",type:"textarea"},model:{value:t.record,callback:function(a){e.$set(t,"record",a)},expression:"item.record"}}):e._e()],1),a("v-uni-view",{staticClass:"td"},[1===t.needPhoto?a("u-upload",{attrs:{fileList:e.fileList[i],name:"1",accept:"image",maxCount:1,previewFullImage:!0},on:{afterRead:function(a){arguments[0]=a=e.$handleEvent(a),e.afterRead(a,t,i)},delete:function(a){arguments[0]=a=e.$handleEvent(a),e.deletePic(a,t,i)}}}):e._e()],1)],1)}))],2),a("u-popup",{attrs:{mode:"bottom",heigth:"50%"},model:{value:e.dialogSparePartVisible,callback:function(t){e.dialogSparePartVisible=t},expression:"dialogSparePartVisible"}},[a("v-uni-view",{staticClass:"content xui-reset"},[a("v-uni-view",{staticClass:"popup-btn__wrapper"},[a("v-uni-view",{staticStyle:{"margin-left":"10rpx","margin-bottom":"5rpx","font-size":"9rpx"}},[a("u-input",{staticStyle:{"margin-left":"20rpx"},attrs:{border:!0,clearable:!0,placeholder:"备件编码",height:e.formItemHeight,"custom-style":{"font-size":"9rpx"}},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.querySparePartTime()}},model:{value:e.partNumber,callback:function(t){e.partNumber=t},expression:"partNumber"}})],1),a("v-uni-view",{staticStyle:{"margin-left":"10rpx","margin-bottom":"5rpx","font-size":"9rpx"}},[a("u-input",{staticStyle:{"margin-left":"20rpx"},attrs:{border:!0,clearable:!0,placeholder:"备件名称",height:e.formItemHeight,"custom-style":{"font-size":"9rpx"}},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.querySparePartTime()}},model:{value:e.partName,callback:function(t){e.partName=t},expression:"partName"}})],1),a("v-uni-button",{staticClass:"mgReset",staticStyle:{"margin-bottom":"5px"},attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.saveSparePartRecord.apply(void 0,arguments)}}},[e._v("保存记录")])],1),a("v-uni-scroll-view",{staticStyle:{height:"250rpx"},attrs:{"scroll-y":"true"}},[a("v-uni-view",{staticClass:"app-containerC wp table-zdy mini-table"},[a("v-uni-view",{staticClass:"th-group"},[a("v-uni-view",{staticClass:"th"},[e._v("备件编码")]),a("v-uni-view",{staticClass:"th"},[e._v("备件名称")]),a("v-uni-view",{staticClass:"th"},[e._v("数量")]),a("v-uni-view",{staticClass:"th",staticStyle:{"justify-content":"left"}},[a("u-checkbox",{staticStyle:{"font-size":"16px","margin-left":"15%"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleChangeAll.apply(void 0,arguments)}},model:{value:e.selectedAll,callback:function(t){e.selectedAll=t},expression:"selectedAll"}},[e._v("使用数量")])],1)],1),e._l(e.sparePartData,(function(t){return a("v-uni-view",{key:t.id,staticClass:"td-group reset-btn-class"},[a("v-uni-view",{staticClass:"td"},[e._v(e._s(t.materialCode))]),a("v-uni-view",{staticClass:"td"},[e._v(e._s(t.materialName))]),a("v-uni-view",{staticClass:"td"},[e._v(e._s(t.quantity))]),a("v-uni-view",{staticClass:"td",staticStyle:{"justify-content":"left"}},[a("u-checkbox",{staticStyle:{"margin-left":"15%"},on:{change:function(a){arguments[0]=a=e.$handleEvent(a),e.handleChangeSingle(t)}},model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"x.checked"}}),a("u-input",{attrs:{placeholder:"请输入使用数量"},model:{value:t.usedQuantity,callback:function(a){e.$set(t,"usedQuantity",a)},expression:"x.usedQuantity"}})],1)],1)}))],2)],1)],1)],1),a("v-uni-view",{staticClass:"wp app-containerR cc"},[a("v-uni-button",{staticClass:"m-20",attrs:{type:"primary",size:"mini"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.keepMaintanceClick.apply(void 0,arguments)}}},[e._v("保存数据")]),a("v-uni-button",{staticClass:"m-20",attrs:{type:"primary",size:"mini"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submitMaintanceClick.apply(void 0,arguments)}}},[e._v("保养完成")]),a("v-uni-button",{staticClass:"m-20",attrs:{size:"mini"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cancelClick.apply(void 0,arguments)}}},[e._v("取消")])],1)],1)},r=[]},"289e":function(e,t,a){"use strict";a.r(t);var i=a("176d"),n=a("4919");for(var r in n)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(r);var c=a("f0c5"),o=Object(c["a"])(n["default"],i["b"],i["c"],!1,null,"1f90ab5e",null,!1,i["a"],void 0);t["default"]=o.exports},"2a97":function(e,t,a){"use strict";a.r(t);var i=a("7e29"),n=a.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(r);t["default"]=n.a},"438e":function(e,t,a){"use strict";a("7a82");var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.acceptFinish=function(e){return new Promise((function(t,a){(0,n.default)({url:"/pbequipment/eqpMtc/acceptMtc",data:e,method:"post"}).then((function(e){t(e)}))}))},t.acceptUser=function(e){return new Promise((function(t,a){(0,n.default)({url:"/pbequipment/eqpMtc/acceptUser",data:e,method:"post"}).then((function(e){t(e)}))}))},t.getAcceptInfo=function(e){return new Promise((function(t,a){(0,n.default)({url:"/pbequipment/eqpMtc/acceptInfo",data:e,method:"get"}).then((function(e){t(e)}))}))},t.getDeviceMaintence=function(e){return new Promise((function(t,a){(0,n.default)({url:"/pbequipment/eqpMtc/mtcPlan",data:e,method:"get"}).then((function(e){t(e)}))}))},t.getDeviceMaintenceItems=function(e){return new Promise((function(t,a){(0,n.default)({url:"/pbequipment/eqpMtc/opInit",data:e,method:"get"}).then((function(e){t(e)}))}))},t.keepMaintenceRec=function(e){return new Promise((function(t,a){(0,n.default)({url:"/pbequipment/eqpMtc/keepMtcRec",data:e,method:"post"}).then((function(e){t(e)}))}))},t.maintenceSubmit=function(e){return new Promise((function(t,a){(0,n.default)({url:"/pbequipment/eqpMtc/mtcSubmit",data:e,method:"post"}).then((function(e){t(e)}))}))},t.sparePartList=function(e){return new Promise((function(t,a){(0,n.default)({url:"/pbequipment/eqpMtc/sparePart",data:e,method:"get"}).then((function(e){t(e)}))}))},t.sparePartUse=function(e){return new Promise((function(t,a){(0,n.default)({url:"/pbequipment/eqpMtc/sparePartUse",data:e,method:"post"}).then((function(e){t(e)}))}))},t.sparePartUseRecord=function(e){return new Promise((function(t,a){(0,n.default)({url:"/pbequipment/eqpMtc/sparePartUseRecord",data:e,method:"get"}).then((function(e){t(e)}))}))},a("d3b7");var n=i(a("3d7c"))},4919:function(e,t,a){"use strict";a.r(t);var i=a("828d"),n=a.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(r);t["default"]=n.a},6066:function(e,t,a){var i=a("6744");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("481cc174",i,!0,{sourceMap:!1,shadowMode:!1})},6744:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */uni-view[data-v-d8ab8e0a], uni-scroll-view[data-v-d8ab8e0a], uni-swiper-item[data-v-d8ab8e0a]{display:flex;flex-direction:column;flex-shrink:0;flex-grow:0;flex-basis:auto;align-items:stretch;align-content:flex-start}.u-checkbox[data-v-d8ab8e0a]{display:flex;flex-direction:row;overflow:hidden;flex-direction:row;align-items:center}.u-checkbox-label--left[data-v-d8ab8e0a]{flex-direction:row}.u-checkbox-label--right[data-v-d8ab8e0a]{flex-direction:row-reverse;justify-content:space-between}.u-checkbox__icon-wrap[data-v-d8ab8e0a]{box-sizing:border-box;transition-property:border-color,background-color,color;transition-duration:.2s;color:#606266;display:flex;flex-direction:row;align-items:center;justify-content:center;color:transparent;text-align:center;margin-right:6px;font-size:6px;border-width:1px;border-color:#c8c9cc;border-style:solid}.u-checkbox__icon-wrap--circle[data-v-d8ab8e0a]{border-radius:100%}.u-checkbox__icon-wrap--square[data-v-d8ab8e0a]{border-radius:3px}.u-checkbox__icon-wrap--checked[data-v-d8ab8e0a]{color:#fff;background-color:red;border-color:#2979ff}.u-checkbox__icon-wrap--disabled[data-v-d8ab8e0a]{background-color:#ebedf0!important}.u-checkbox__icon-wrap--disabled--checked[data-v-d8ab8e0a]{color:#c8c9cc!important}.u-checkbox__label[data-v-d8ab8e0a]{word-wrap:break-word;margin-left:5px;margin-right:12px;color:#606266;font-size:15px}.u-checkbox__label--disabled[data-v-d8ab8e0a]{color:#c8c9cc}',""]),e.exports=t},"76cd":function(e,t,a){"use strict";a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("a9e3");var i={props:{name:{type:[String,Number,Boolean],default:uni.$u.props.checkbox.name},shape:{type:String,default:uni.$u.props.checkbox.shape},size:{type:[String,Number],default:uni.$u.props.checkbox.size},checked:{type:Boolean,default:uni.$u.props.checkbox.checked},disabled:{type:[String,Boolean],default:uni.$u.props.checkbox.disabled},activeColor:{type:String,default:uni.$u.props.checkbox.activeColor},inactiveColor:{type:String,default:uni.$u.props.checkbox.inactiveColor},iconSize:{type:[String,Number],default:uni.$u.props.checkbox.iconSize},iconColor:{type:String,default:uni.$u.props.checkbox.iconColor},label:{type:[String,Number],default:uni.$u.props.checkbox.label},labelSize:{type:[String,Number],default:uni.$u.props.checkbox.labelSize},labelColor:{type:String,default:uni.$u.props.checkbox.labelColor},labelDisabled:{type:[String,Boolean],default:uni.$u.props.checkbox.labelDisabled}}};t.default=i},7891:function(e,t,a){"use strict";var i=a("6066"),n=a.n(i);n.a},"7e29":function(e,t,a){"use strict";a("7a82");var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14d9"),a("ac1f"),a("00b4"),a("d3b7");var n=i(a("76cd")),r={name:"u-checkbox",mixins:[uni.$u.mpMixin,uni.$u.mixin,n.default],data:function(){return{isChecked:!1,parentData:{iconSize:12,labelDisabled:null,disabled:null,shape:"square",activeColor:null,inactiveColor:null,size:18,value:null,iconColor:null,placement:"row",borderBottom:!1,iconPlacement:"left"}}},computed:{elDisabled:function(){return""!==this.disabled?this.disabled:null!==this.parentData.disabled&&this.parentData.disabled},elLabelDisabled:function(){return""!==this.labelDisabled?this.labelDisabled:null!==this.parentData.labelDisabled&&this.parentData.labelDisabled},elSize:function(){return this.size?this.size:this.parentData.size?this.parentData.size:21},elIconSize:function(){return this.iconSize?this.iconSize:this.parentData.iconSize?this.parentData.iconSize:12},elActiveColor:function(){return this.activeColor?this.activeColor:this.parentData.activeColor?this.parentData.activeColor:"#2979ff"},elInactiveColor:function(){return this.inactiveColor?this.inactiveColor:this.parentData.inactiveColor?this.parentData.inactiveColor:"#c8c9cc"},elLabelColor:function(){return this.labelColor?this.labelColor:this.parentData.labelColor?this.parentData.labelColor:"#606266"},elShape:function(){return this.shape?this.shape:this.parentData.shape?this.parentData.shape:"circle"},elLabelSize:function(){return uni.$u.addUnit(this.labelSize?this.labelSize:this.parentData.labelSize?this.parentData.labelSize:"15")},elIconColor:function(){var e=this.iconColor?this.iconColor:this.parentData.iconColor?this.parentData.iconColor:"#ffffff";return this.elDisabled?this.isChecked?this.elInactiveColor:"transparent":this.isChecked?e:"transparent"},iconClasses:function(){var e=[];return e.push("u-checkbox__icon-wrap--"+this.elShape),this.elDisabled&&e.push("u-checkbox__icon-wrap--disabled"),this.isChecked&&this.elDisabled&&e.push("u-checkbox__icon-wrap--disabled--checked"),e},iconWrapStyle:function(){var e={};return e.backgroundColor=this.isChecked&&!this.elDisabled?this.elActiveColor:"#ffffff",e.borderColor=this.isChecked&&!this.elDisabled?this.elActiveColor:this.elInactiveColor,e.width=uni.$u.addUnit(this.elSize),e.height=uni.$u.addUnit(this.elSize),"right"===this.parentData.iconPlacement&&(e.marginRight=0),e},checkboxStyle:function(){var e={};return this.parentData.borderBottom&&"row"===this.parentData.placement&&uni.$u.error("检测到您将borderBottom设置为true，需要同时将u-checkbox-group的placement设置为column才有效"),this.parentData.borderBottom&&"column"===this.parentData.placement&&(e.paddingBottom="8px"),uni.$u.deepMerge(e,uni.$u.addStyle(this.customStyle))}},mounted:function(){this.init()},methods:{init:function(){var e=this;this.updateParentData(),this.parent||uni.$u.error("u-checkbox必须搭配u-checkbox-group组件使用"),this.checked?this.isChecked=!0:uni.$u.test.array(this.parentData.value)&&(this.isChecked=this.parentData.value.some((function(t){return t===e.name})))},updateParentData:function(){this.getParentData("u-checkbox-group")},wrapperClickHandler:function(e){"right"===this.parentData.iconPlacement&&this.iconClickHandler(e)},iconClickHandler:function(e){this.preventEvent(e),this.elDisabled||this.setRadioCheckedStatus()},labelClickHandler:function(e){this.preventEvent(e),this.elLabelDisabled||this.elDisabled||this.setRadioCheckedStatus()},emitEvent:function(){var e=this;this.$emit("change",this.isChecked),this.$nextTick((function(){uni.$u.formValidate(e,"change")}))},setRadioCheckedStatus:function(){this.isChecked=!this.isChecked,this.emitEvent(),"function"===typeof this.parent.unCheckedOther&&this.parent.unCheckedOther(this)}},watch:{checked:function(){this.isChecked=this.checked}}};t.default=r},"828d":function(e,t,a){"use strict";a("7a82");var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a("c7eb")),r=i(a("5530")),c=i(a("1da1"));a("d3b7"),a("159b"),a("14d9"),a("a434"),a("99af"),a("baa5"),a("c975"),a("d81d");var o=a("438e"),s=a("70f3"),l=a("e237"),u=a("9b6c"),d=i(a("b841")),p={data:function(){return{maintenanceItemSData:"",mtcDspId:"",deviceItem:"",title:"chooseVideo",sourceTypeIndex:2,fileList:[],cameraIndex:0,dialogSparePartVisible:!1,formItemHeight:24,partNumber:null,partName:null,sparePartData:[],selectedAll:!1,usedSparePart:"",selectedPart:[],timer:null}},onLoad:function(e){var t=this;this.maintenanceItemSData=[],this.deviceItem=JSON.parse(e.deviceItem),this.deviceItem.mtcId=this.deviceItem.ckOrMtcId,this.deviceItem.mtcDspId=this.deviceItem.attribute1,(0,o.getDeviceMaintenceItems)(this.deviceItem).then((function(e){t.maintenanceItemSData=e.data.items,t.mtcDspId=e.data.mtcDspId,t.maintenanceItemSData.forEach((function(e){e.illId=(0,s.getFileServerUrl)()+e.illId,e.imageToShow=e.photoPath,e.imageToShow?t.fileList.push([{url:(0,s.getFileServerUrl)()+e.imageToShow}]):t.fileList.push([])})),console.log("保养项数据",e,t.maintenanceItemSData),t.querySparePart()}))},methods:{keepMaintanceClick:function(){var e=[];this.maintenanceItemSData.forEach((function(t){e.push({miId:t.id,record:t.record||"",step:t.step,photoPath:t.imageToShow})}));var t={mtcDspId:this.mtcDspId,itemRecList:e};console.log("param",t),(0,o.keepMaintenceRec)(t).then((function(e){console.log(e),uni.navigateBack()}))},submitMaintanceClick:function(){var e=[],t=!0,a=0,i=0;this.maintenanceItemSData.forEach((function(n){n.imageToShow||1!==n.needPhoto||(t=!1,a=n.step),""!=n.record&&n.record||1!==n.needText||(t=!1,i=n.step),e.push({miId:n.id,record:n.record||"",step:n.step,photoPath:n.imageToShow})}));var n={mtcDspId:this.mtcDspId,itemRecList:e};if(1==t)(0,o.maintenceSubmit)(n).then((function(e){console.log(e),uni.navigateBack()}));else{var r="";0!=i&&0!=a?r+="第"+a+"步未拍摄操作照片!第"+i+"步未填写文字说明!请核对~":0==i&&0!=a?r+="第"+a+"步未拍摄操作照片!请核对~":0==a&&0!=i&&(r+="第"+i+"步未填写文字说明!请核对~"),console.log(r),(0,u.$confirm)(r).then((function(e){}))}},cancelClick:function(){uni.navigateBack()},deletePic:function(e,t,a){t.imageToShow="",this.fileList[a].splice(e.index,1)},afterRead:function(e,t,a){var i=this;return(0,c.default)((0,n.default)().mark((function c(){var o,l,u,d,p,h,f,m;return(0,n.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=[].concat(e.file),l=["jpg","png","jepg","jpeg","img","gif"],u=!1,o.forEach((function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1);u=-1===l.indexOf(t.toLowerCase())})),!u){n.next=7;break}return uni.showToast({icon:"none",title:"请选择图片"}),n.abrupt("return");case 7:d=i.fileList[a].length,o.map((function(e){i.fileList[a].push((0,r.default)((0,r.default)({},e),{},{status:"uploading",message:"上传中"}))})),p=0;case 10:if(!(p<o.length)){n.next=23;break}return n.next=13,i.uploadFilePromise(o[p].url);case 13:h=n.sent,t.imageToShow=h,f=i.fileList[a][d],i.fileList[a].splice(d,1,Object.assign(f,{status:"success",message:"",url:h})),d++,m=(0,s.getFileServerUrl)()+h,i.fileList[a]=[{url:m}];case 20:p++,n.next=10;break;case 23:case"end":return n.stop()}}),c)})))()},uploadFilePromise:function(e){return new Promise((function(t,a){d.default.upload({token:(0,l.getToken)(),filePath:e}).then((function(e){if(200!==e.code)return t({status:500,msg:"上传失败"});setTimeout((function(){return t(e.data.filePath)}),150)}))}))},consumptionClick:function(){this.dialogSparePartVisible=!0,this.querySparePart()},querySparePartTime:function(){var e=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){e.querySparePart()}),800)},querySparePart:function(){var e=this;console.log("start"),(0,o.sparePartList)({materialCode:this.partNumber,materialName:this.partName,pageSize:1e3,pageNum:1}).then((function(t){e.sparePartData=t.data,e.sparePartData.forEach((function(t){var a=!1,i=null;e.selectedPart.forEach((function(e){t.id===e.spId&&(a=e.checked,i=e.quantity)})),t.checked=a,t.usedQuantity=i})),(0,o.sparePartUseRecord)({orderNum:e.mtcDspId}).then((function(t){if(t.data){var a=t.data;console.log(t.data),a.forEach((function(t){e.sparePartData.forEach((function(a){t.materialCode==a.materialCode&&(console.log(a),a.checked=!0,a.usedQuantity=t.quantity,e.checkedPart(a))}))}))}}))}))},handleChangeAll:function(e){var t=this;this.usedSparePart="",this.sparePartData.forEach((function(a){a.checked=e.value,t.checkedPart(a)})),this.selectedPart.forEach((function(e){t.usedSparePart=t.usedSparePart+e.materialName+"("+e.quantity+");"}))},handleChangeSingle:function(e){var t=this;this.$nextTick((function(){var e=!1;t.sparePartData.some((function(t){return!t.checked&&(e=!0,!0)})),t.selectedAll=!e,t.sparePartData.forEach((function(e){t.checkedPart(e)}))}))},checkedPart:function(e){var t=this,a=!1;this.selectedPart.map((function(i,n){e.id===i.spId&&(e.checked?a=!0:t.selectedPart.splice(n,1))})),!a&&e.checked&&this.selectedPart.push({spId:e.id,checked:e.checked,materialCode:e.materialCode,materialName:e.materialName,reQuantity:e.quantity,quantity:e.usedQuantity,usedId:this.mtcDspId,usedFrom:0})},saveSparePartRecord:function(){var e=this,t=!1;this.sparePartData.forEach((function(t){e.checkedPart(t)})),this.selectedPart.forEach((function(e){if(null==e.quantity||0===e.quantity||""==e.quantity)return uni.showToast({title:"未输入消耗数量！"}),void(t=!0)})),t||(0,o.sparePartUse)({usedSparePart:this.selectedPart,orderNo:this.mtcDspId}).then((function(t){1e4==t.err_code?e.dialogSparePartVisible=!1:uni.showToast({icon:"error",title:t.err_msg,duration:1e3})}))}}};t.default=p},d94f:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return i}));var i={uIcon:a("3c3f").default},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"u-checkbox",class:["u-checkbox-label--"+e.parentData.iconPlacement,e.parentData.borderBottom&&"column"===e.parentData.placement&&"u-border-bottom"],style:[e.checkboxStyle],on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.wrapperClickHandler.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"u-checkbox__icon-wrap",class:e.iconClasses,style:[e.iconWrapStyle],on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.iconClickHandler.apply(void 0,arguments)}}},[e._t("icon",[a("u-icon",{staticClass:"u-checkbox__icon-wrap__icon",attrs:{name:"checkbox-mark",size:e.elIconSize,color:e.elIconColor}})])],2),a("v-uni-text",{style:{color:e.elDisabled?e.elInactiveColor:e.elLabelColor,fontSize:e.elLabelSize,lineHeight:e.elLabelSize},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.labelClickHandler.apply(void 0,arguments)}}},[e._v(e._s(e.label))])],1)},r=[]}}]);